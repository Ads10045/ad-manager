<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.tailwindcss.com"></script>
    <title>Bannière Achats Matériaux</title>
</head>
<body class="bg-gray-100 flex items-center justify-center h-screen p-4">
    <div class="max-w-4xl w-full bg-white rounded-2xl shadow-2xl overflow-hidden flex flex-col md:flex-row border-4 border-orange-500">
        <!-- Section Visuelle -->
        <div class="md:w-1/3 bg-orange-600 p-8 flex items-center justify-center">
            <img id="product-image" src="https://via.placeholder.com/300?text=Chargement..." alt="Produit" class="max-h-64 object-contain drop-shadow-2xl rounded-lg">
        </div>

        <!-- Section Contenu -->
        <div class="md:w-2/3 p-8 flex flex-col justify-between">
            <div>
                <div class="flex justify-between items-start mb-4">
                    <span class="bg-orange-100 text-orange-700 px-3 py-1 rounded-full text-xs font-bold uppercase tracking-widest">Offre Spéciale</span>
                    <span class="text-gray-400 text-xs font-mono">ID: <span id="product-id">-------</span></span>
                </div>
                <h1 id="product-name" class="text-4xl font-bold text-gray-800 leading-tight uppercase tracking-tighter">Chargement...</h1>
                <p id="product-desc" class="text-gray-600 mt-4 text-lg line-clamp-2">Récupération des données en cours...</p>
            </div>

            <div class="mt-8 flex items-center gap-6">
                <div>
                    <span class="block text-gray-400 text-xs font-bold uppercase mb-1">Prix Pro</span>
                    <span class="text-4xl font-black text-orange-600"><span id="product-price">--.--</span> €</span>
                </div>
                <a id="product-link" href="#" target="_blank" class="bg-orange-600 hover:bg-orange-700 text-white font-bold py-4 px-10 rounded-xl transition-all shadow-lg hover:shadow-orange-200 uppercase tracking-widest">Acheter Maintenant</a>
            </div>
        </div>
    </div>

    <!-- Script jQuery pour l'injection dynamique -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script>
        $(document).ready(function() {
            const API_URL = 'http://localhost:3001/api/products';
            
            console.log("Démarrage de l'injection jQuery...");
            
            $.get(API_URL, function(products) {
                if (products && products.length > 0) {
                    const product = products[Math.floor(Math.random() * products.length)];
                    console.log("Produit sélectionné :", product.name);

                    // Mise à jour du DOM
                    $('#product-image').attr('src', product.imageUrl || '');
                    $('#product-image').attr('alt', product.name);
                    $('#product-name').text(product.name);
                    $('#product-desc').text(product.description || 'Description non disponible.');
                    $('#product-price').text(product.price);
                    $('#product-id').text(product.id.substring(0, 8));
                    $('#product-link').attr('href', product.sourceUrl || '#');
                }
            }).fail(function() {
                console.error("Erreur : Impossible de contacter l'API. Assurez-vous que le serveur tourne sur le port 3001.");
                $('#product-name').text("Erreur de connexion");
            });
        });
    </script>
</body>
</html>
